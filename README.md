# 🎮 鳴潮 音骸スコアチェッカー

ブラウザ上で動作する「鳴潮（Wuthering Waves）」の音骸（キャラクター）のステータススコアチェッカーです。スクリーンショットからOCRでステータスを自動認識し、最適なスコア計算を行います。

## ✨ 機能

### 画像入力
- **クリップボードペースト対応**: ゲーム画面のスクリーンショットをコピー → ブラウザに貼り付け（Ctrl+V）で自動処理
- **ドラッグ&ドロップ対応**: 画像ファイルをドラッグして直接アップロード
- **FHD（1920x1080）スクショに対応**: その他の解像度でも自動スケーリング

### 画像処理
- **OpenCV.js** による高度な前処理
  - グレースケール化
  - 二値化（Otsu's method）
  - ノイズ除去（モルフォロジー演算）
  - 自動クロップ

### OCR（文字認識）
- **Tesseract.js** を使用した日本語・数字認識
- 複数の正規表現パターンによる正確な数値抽出
- フォールバック処理により誤認識に対応

### スコア計算
以下のステータスから総合スコアを計算：

| ステータス | 重み | 説明 |
|-----------|------|------|
| 攻撃力 | 1.0 | DPS重視 |
| 会心率 | **2.0** | 最重要パラメータ |
| 会心ダメージ | 1.0 | ダメージ係数 |
| 防御力 | 0.5 | サバイバル |
| HP | 0.5 | サバイバル |
| ヒール効果 | 0.3 | 回復効率 |
| 全耐性 | 0.8 | 耐性バランス |

**スコア計算式:**
```
総合スコア = Σ(各ステータス値 × 対応する重み)
```

### UI機能
- 📊 **リアルタイムプレビュー**: 元画像、クロップ領域、処理済み画像を同時表示
- 📈 **詳細な結果表示**: 各ステータスの値とスコア内訳を表示
- 💾 **結果ダウンロード**: JSON形式で結果をダウンロード可能
- 🎨 **モダンUIデザイン**: ダークテーマ、グラデーション、スムーズなアニメーション

## 🛠️ 技術スタック

| 項目 | 技術 |
|------|------|
| **言語** | HTML5, CSS3, JavaScript (ES6+) |
| **画像処理** | OpenCV.js 4.5.2 |
| **OCR** | Tesseract.js 5.1.0 |
| **ホスティング** | GitHub Pages（静的サイト） |
| **サーバーサイド** | なし（フロントエンドのみで完結） |

## 🚀 使い方

### 1. アプリを開く
GitHub Pagesでホストされたアプリを開く
```
https://[username].github.io/Wuthering-Waves-score/
```

### 2. スクリーンショットを撮る
ゲーム内で音骸のステータス画面を表示し、スクリーンショットを撮ります（推奨：FHD 1920x1080）

### 3. 貼り付ける
以下の方法でスクショをアプリに入力：

**方法A: クリップボードペースト（推奨）**
```
1. スクショをコピー (Ctrl+C / Cmd+C)
2. アプリの入力エリアに貼り付け (Ctrl+V / Cmd+V)
```

**方法B: ドラッグ&ドロップ**
```
1. ファイルをドラッグしてドロップゾーンに落とす
```

### 4. 結果確認
自動的に以下が表示されます：
- ✅ 認識されたステータス値
- 📊 総合スコア
- 💡 スコア内訳の詳細

### 5. 結果をダウンロード（オプション）
「結果をダウンロード」ボタンで JSON 形式で保存可能

## ⚙️ 技術的な詳細

### OpenCV.js の処理フロー
```
入力画像
  ↓
グレースケール化 (cvtColor)
  ↓
二値化 (threshold with Otsu)
  ↓
モルフォロジー演算 (morphologyEx)
  ↓
ROI抽出 (自動クロップ)
  ↓
処理済み画像
```

### ステータス領域の座標定義
FHD（1920x1080）を基準に以下の領域からステータスを抽出：
- **X軸**: 65% ～ 95%（右側のステータスパネル）
- **Y軸**: 15% ～ 85%（画面中央～下部）

自動的にスケーリングされるため、他の解像度でも対応可能です。

### OCR テキスト解析
複数の正規表現パターンで以下のフォーマットに対応：
```
攻撃力: 150.5
HP: 75.3
防御力: 60.2
会心率: 45.8
会心ダメージ: 120.0
ヒール効果: 35.0
全耐性: 30.5
```

フォールバック処理により、改行で区切られたテキストもサポート。

## 📋 動作環境

- **ブラウザ**: Chrome, Firefox, Safari, Edge（最新版推奨）
- **メモリ**: 512MB 以上（OpenCV.js 使用）
- **ネットワーク**: インターネット接続（ライブラリ CDN から読み込み）
- **対応 OS**: Windows, macOS, Linux

## ⚠️ 注意事項

### 解像度について
- **推奨**: FHD（1920x1080）
- **サポート**: その他の解像度も自動スケーリングで対応
- 極度に異なる解像度（720p など）の場合、座標がずれる可能性あり

### OCR精度について
- ゲーム特有のフォントにより「0」と「O」、「1」と「I」の誤認識が稀に発生
- 複数回の実行や入力画像の品質改善で対応可能

### パフォーマンス
- 初回起動時: OpenCV.js と Tesseract.js をロード（10 ～ 20秒程度）
- 画像処理: 通常 5 ～ 15秒（デバイスの性能に依存）

## 📦 ファイル構成

```
Wuthering-Waves-score/
├── index.html          # メイン HTML ファイル
├── style.css           # スタイルシート
├── script.js           # メイン処理スクリプト
├── README.md           # このファイル
└── .gitignore          # Git 設定
```

## 🔧 ローカル開発

### セットアップ
```bash
# リポジトリをクローン
git clone https://github.com/[username]/Wuthering-Waves-score.git
cd Wuthering-Waves-score

# ローカルサーバーで実行
# Python 3.x
python -m http.server 8000

# または Node.js
npx http-server
```

### ブラウザで確認
```
http://localhost:8000
```

## 🐛 トラブルシューティング

### OpenCV.js が読み込めない
- ネットワーク接続を確認
- ブラウザのコンソール（F12）でエラーを確認
- CDN が利用可能か確認（https://docs.opencv.org/4.5.2/opencv.js）

### Tesseract.js が初期化できない
- メモリ不足の可能性
- ブラウザを再起動して再試行

### OCR が正しく認識されない
- 画像の品質を確認（暗すぎたり、ぼやけていないか）
- ゲーム画面の解像度を確認（FHD 推奨）
- 複数回実行してみる

### スコア計算結果がおかしい
- ステータスが正しく認識されているか確認
- プレビュー画像でクロップ領域が正しいか確認
- コンソール（F12）で OCR 結果を確認

## 📝 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

## 🙏 謝辞

- [OpenCV.js](https://docs.opencv.org/4.5.2/) - コンピュータビジョンライブラリ
- [Tesseract.js](https://tesseract.projectnaptha.com/) - OCR エンジン
- [鳴潮（Wuthering Waves）](https://www.wutheringwaves.com/) - ゲーム

## 📞 サポート

問題や機能リクエストは GitHub Issues で報告してください。

---

**最終更新**: 2025年12月21日
**バージョン**: 1.0.0
